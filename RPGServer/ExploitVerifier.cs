using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace MainServer
{
    static class ExploitVerifier
    {
        /// <summary>
        /// Verifies that the player character logged in on this server is the last known logged in for the entire account. If not, player may be multi-logging using custom software
        /// </summary>
        /// <param name="accountID"></param>
        /// <param name="currentPlayerID"></param>
        /// <param name="currentWorldID"></param>
        /// <returns></returns>
        public static bool IsLastCharacterLoggedIn(long accountID, int currentPlayerID, int currentWorldID)
        {
            bool valid = true;
            SqlQuery query = new SqlQuery(Program.processor.m_universalHubDB, "select last_selected_character from account_details where account_id=" + accountID);
            if (query.Read())
            {
                var lastChar = query.GetInt32("last_selected_character");
            
                if (lastChar != currentPlayerID)
                    valid = false;


            }
            query.Close();
            return valid;
        }
    }
}
